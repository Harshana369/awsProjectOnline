(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1299],{16755:(e,s,n)=>{"use strict";n.r(s),n.d(s,{default:()=>z});var a=n(72791),t=n(79271),r=n(74569),i=n.n(r),l=n(3986),o=n(2468),c=n(79836),d=n(53382),h=n(53994),x=n(39281),j=n(56890),Z=n(35855),p=n(10703),m=n(56125),u=n(13400),g=n(85172),f=n(95678),S=n(20890),b=n(70546),k=(n(58484),n(43360)),y=n(39474),w=n(16149),v=n(47022),N=n(89743),D=n(2677),C=n(29818),I=n(64554),P=n(39157),T=n(13239),A=n(16494),O=n(64802),B=n(80184);function H(e){const{row:s}=e,[n,t]=a.useState(!1);let[r,i]=(0,a.useState)(!1),[x,p]=(0,a.useState)([]);function b(){i(!0)}return(0,B.jsxs)(a.Fragment,{children:[(0,B.jsxs)(Z.Z,{sx:{"& > *":{borderBottom:"unset"}},style:{height:10},padding:"none",children:[(0,B.jsx)(h.Z,{children:(0,B.jsx)(u.Z,{"aria-label":"expand row",size:"small",onClick:()=>t(!n),children:n?(0,B.jsx)(f.Z,{}):(0,B.jsx)(g.Z,{})})}),(0,B.jsx)(h.Z,{component:"th",scope:"row",children:s.taskRef}),(0,B.jsx)(h.Z,{children:"undefined"===typeof s.siteID?"NA":s.siteID}),(0,B.jsx)(h.Z,{children:"undefined"===typeof s.assignedSubcon?"NA":s.assignedSubcon.companyName}),(0,B.jsx)(h.Z,{children:"undefined"===typeof s.assignedMobitelOfficer?"NA":s.assignedMobitelOfficer.name}),(0,B.jsx)(h.Z,{children:s.taskStatus}),(0,B.jsx)(h.Z,{children:(0,B.jsx)(k.Z,{onClick:()=>b(s.id),startIcon:(0,B.jsx)(A.Z,{color:"inherit"}),children:(0,B.jsx)(A.Z,{onClick:()=>b(s.id)})})})]}),(0,B.jsx)(Z.Z,{children:(0,B.jsx)(h.Z,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:(0,B.jsx)(m.Z,{in:n,timeout:"auto",unmountOnExit:!0,children:(0,B.jsxs)(I.Z,{sx:{margin:1},children:[(0,B.jsx)(S.Z,{variant:"h6",gutterBottom:!0,component:"div",children:"History"}),(0,B.jsxs)(c.Z,{size:"small","aria-label":"purchases",children:[(0,B.jsx)(j.Z,{children:(0,B.jsxs)(Z.Z,{children:[(0,B.jsx)(h.Z,{children:"Action"}),(0,B.jsx)(h.Z,{children:"Performed by"}),(0,B.jsx)(h.Z,{children:"Date"}),(0,B.jsx)(h.Z,{children:"Comment"})]})}),(0,B.jsx)(d.Z,{children:s.taskHistory.map((e=>(0,B.jsxs)(Z.Z,{children:[(0,B.jsxs)(h.Z,{children:[e.taskStatus,e.comStatus,e.sarStatus,e.patStatus,e.onairStatus]}),(0,B.jsx)(h.Z,{children:e.performedBy.name}),(0,B.jsx)(h.Z,{component:"th",scope:"row",children:e.performedDate.split("T")[0]}),(0,B.jsx)(h.Z,{children:e.comment})]},e.performedDate)))})]})]})})})}),(0,B.jsx)(y.Z,{show:r,onHide:function(){i(!1)},animation:!1,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,B.jsxs)(I.Z,{sx:o.Z,children:[(0,B.jsx)(y.Z.Header,{closeButton:!0,children:(0,B.jsx)(y.Z.Title,{children:"Handover Details"})}),!0===r?(0,B.jsxs)(y.Z.Body,{children:[(0,B.jsx)("div",{children:(0,B.jsxs)(w.Z.Label,{style:{fontWeight:"normal"},children:["Site ID : ",s.siteID]})}),(0,B.jsx)("div",{children:(0,B.jsxs)(w.Z.Label,{style:{fontWeight:"normal"},children:["Site Name : ",s.siteName]})}),(0,B.jsx)("div",{className:"mb-3",children:(0,B.jsxs)(w.Z.Label,{style:{fontWeight:"normal"},children:["Task ID : ",s.taskRef]})}),(0,B.jsx)("div",{style:{height:500},children:(0,B.jsx)(l._$r,{rows:s.headerProperties.map(((e,n)=>({id:n,DataField:e,Info:s.properties[n]}))),columns:[{field:"DataField",headerName:"Data Field",flex:1},{field:"Info",headerName:"Info",flex:1}],pageSize:15,rowsPerPageOptions:[15],rowHeight:25,headerHeight:30,components:{Toolbar:l.npt}})})]}):null]})})]})}const z=(0,t.EN)((function(){let[e,s]=(0,a.useState)([]);const[n,t]=(0,a.useState)([]),[r,l]=(0,a.useState)(""),[o,m]=a.useState(10),[u,g]=a.useState(0),[f,S]=a.useState(0);let[y,A]=(0,a.useState)(!1);const[z,E]=a.useState(10),[R,L]=(0,a.useState)(0),[F,J]=(0,a.useState)(0),W=i().create({baseURL:"http://35.78.68.113:8072"});return(0,a.useEffect)((()=>{A(!0);(async()=>{try{const e=await W.get("projonline/getalltasksfortable?pageSize=".concat(o,"&pageNumber=").concat(u+1),{headers:{token:"Bearer "+JSON.parse(localStorage.getItem("user")).accessToken}});s(e.data.tasks),L(e.data.totalTasks),A(!1)}catch(e){console.log(e)}})()}),[o,u]),(0,a.useEffect)((()=>{(async e=>{try{A(!0);const n=await W.get(e,{headers:{token:"Bearer "+JSON.parse(localStorage.getItem("user")).accessToken}});s(n.data.tasks),L(n.data.totalTasks),A(!1)}catch(n){console.log(n),A(!1)}})("projonline/getalltasksfortable?pageSize=10&pageNumber=1")}),[]),(0,B.jsxs)("div",{children:[(0,B.jsxs)("div",{className:"content-wrapper",children:[(0,B.jsx)("div",{className:"content-header",children:(0,B.jsx)("section",{className:"content-header",children:(0,B.jsx)("div",{className:"container-fluid",children:(0,B.jsx)("div",{children:(0,B.jsx)("div",{children:(0,B.jsx)(v.Z,{children:(0,B.jsxs)(N.Z,{children:[(0,B.jsx)(D.Z,{xs:2,children:(0,B.jsx)("h1",{children:"All Tasks"})}),(0,B.jsx)(D.Z,{xs:7,children:(0,B.jsx)(w.Z.Control,{className:"me-auto",placeholder:"Search your item here...",onChange:e=>l(e.target.value)})}),(0,B.jsx)(D.Z,{children:(0,B.jsx)(k.Z,{variant:"secondary",onClick:async()=>{try{A(!0),console.log(r);const e=await W.get("projonline/searchtasks?search=".concat(r),{headers:{token:"Bearer "+JSON.parse(localStorage.getItem("user")).accessToken}});t(e.data.tasks),J(e.data.tasks.length),A(!1)}catch(e){console.log(e),A(!1)}},children:"Search"})}),(0,B.jsx)(D.Z,{children:(0,B.jsx)("div",{className:"vr"})}),(0,B.jsx)(D.Z,{children:(0,B.jsx)(k.Z,{variant:"warning",onClick:async()=>{window.location.reload()},children:"Reload"})}),(0,B.jsx)(D.Z,{children:(0,B.jsx)(k.Z,{onClick:async()=>{try{const e=await W.get("projonline/downloadAllTasksData",{responseType:"arraybuffer"}),s=new Date,n={timeZone:"Asia/Colombo"},a=s.toLocaleString("en-US",n);(0,O.saveAs)(new Blob([e.data]),"AllTaskExport-".concat(a,".xlsx"))}catch(e){console.error("Error downloading file:",e)}},children:"Download"})})]})})})})})})}),(0,B.jsx)("div",{children:(0,B.jsx)("div",{children:F>0?(0,B.jsxs)("div",{children:[(0,B.jsx)(x.Z,{component:p.Z,children:(0,B.jsxs)(c.Z,{size:"small","aria-label":"collapsible table",children:[(0,B.jsx)(j.Z,{children:(0,B.jsxs)(Z.Z,{children:[(0,B.jsx)(h.Z,{}),(0,B.jsx)(h.Z,{children:"Task ID"}),(0,B.jsx)(h.Z,{children:"Site ID"}),(0,B.jsx)(h.Z,{children:"Assigned Subcon / Vender"}),(0,B.jsx)(h.Z,{children:"Assigned Officer"}),(0,B.jsx)(h.Z,{children:"Current Status"}),(0,B.jsx)(h.Z,{children:"Handover"})]})}),(0,B.jsx)(d.Z,{children:n.slice(f*z,f*z+z).map((e=>(0,B.jsx)(H,{row:e},e.name)))})]})}),(0,B.jsx)(b.Z,{rowsPerPageOptions:[5,10,25,50,100],component:"div",count:F,rowsPerPage:z,page:f,onPageChange:(e,s)=>{S(s)},onRowsPerPageChange:e=>{E(parseInt(e.target.value,10)),S(0)}})]}):(0,B.jsxs)("div",{children:[(0,B.jsx)(x.Z,{component:p.Z,children:(0,B.jsxs)(c.Z,{size:"small","aria-label":"collapsible table",children:[(0,B.jsx)(j.Z,{children:(0,B.jsxs)(Z.Z,{children:[(0,B.jsx)(h.Z,{}),(0,B.jsx)(h.Z,{children:"Task ID"}),(0,B.jsx)(h.Z,{children:"Site ID"}),(0,B.jsx)(h.Z,{children:"Assigned Subcon / Vender"}),(0,B.jsx)(h.Z,{children:"Assigned Officer"}),(0,B.jsx)(h.Z,{children:"Current Status"}),(0,B.jsx)(h.Z,{children:"Handover"})]})}),(0,B.jsx)(d.Z,{children:(e>0?e.slice(u*o,u*o+o):e).map((e=>(0,B.jsx)(H,{row:e},e.name)))})]})}),(0,B.jsx)(b.Z,{rowsPerPageOptions:[5,10,25,50,100],component:"div",count:R,rowsPerPage:o,page:u,onPageChange:(e,s)=>{g(s)},onRowsPerPageChange:e=>{m(parseInt(e.target.value,10)),g(0)}})]})})})]}),(0,B.jsx)(C.Z,{open:y,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:(0,B.jsx)(P.Z,{children:(0,B.jsx)(I.Z,{sx:{display:"flex"},children:(0,B.jsx)(T.Z,{})})})})]})}))},2468:(e,s,n)=>{"use strict";n.d(s,{Z:()=>a});const a={}},55382:()=>{},72095:()=>{},61219:()=>{}}]);
//# sourceMappingURL=1299.25e4da52.chunk.js.map