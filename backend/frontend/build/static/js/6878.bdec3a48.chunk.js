(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6878],{60743:(e,a,o)=>{"use strict";o.r(a),o.d(a,{default:()=>C});var i=o(72791),n=o(79271),s=o(74569),t=o.n(s),l=o(89743),r=o(16149),c=o(2677),d=o(43360),h=o(34575),m=o(19658),u=(o(58484),o(97473),o(64554)),p=o(39157),v=o(13239),j=o(29818),x=o(80184);const b=i.forwardRef((function(e,a){return(0,x.jsx)(m.Z,{elevation:6,ref:a,variant:"filled",...e})}));const C=(0,n.EN)((function(e){let[a,o]=(0,i.useState)([]),[n,s]=(0,i.useState)([]),[m,C]=(0,i.useState)(""),[y,Z]=(0,i.useState)("");const g=t().create({baseURL:"http://ec2-65-2-5-82.ap-south-1.compute.amazonaws.com/"});let[w,N]=(0,i.useState)({}),[f,k]=(0,i.useState)({}),[P,_]=(0,i.useState)(!1),[O,S]=(0,i.useState)(!1),T=(e,a)=>{N({...w,[e]:a}),f[e]&&k({...f,[e]:null})};(0,i.useEffect)((()=>{g.get("projonline/users",{headers:{token:"Bearer "+JSON.parse(localStorage.getItem("user")).accessToken}}).then((a=>{if(o(a.data.users.filter((e=>"Mobitel"===e.company.companyName))),s(a.data.companys),"Mobitel"===e.location.data.row.company.companyName){let a="",o="",i="";switch(e.location.data.row.approvalPath.length){case 0:a="1",o="1",i="1";break;case 1:a=e.location.data.row.approvalPath[0]._id,o="1",i="1";break;case 2:a=e.location.data.row.approvalPath[0]._id,o="2",i=e.location.data.row.approvalPath[1]._id;break;case 3:a=e.location.data.row.approvalPath[0]._id,o=e.location.data.row.approvalPath[1]._id,i=e.location.data.row.approvalPath[2]._id}N({name:e.location.data.row.name,email:e.location.data.row.email,company:e.location.data.row.company.companyName,userDiv:e.location.data.row.userDiv,mobileNo:e.location.data.row.mobileNo,username:e.location.data.row.username,adminRights:e.location.data.row.adminRights,activeStatus:e.location.data.row.activeStatus,userCanAssignForTask:e.location.data.row.userCanAssignForTask,visbilityBasedOn:e.location.data.row.visbilityBasedOn,projectCoordinator:e.location.data.row.projectCoordinator,isProjectCoordinator:e.location.data.row.isProjectCoordinator,verificationOneId:a,verificationTwoId:o,approvalId:i})}else N({name:e.location.data.row.name,email:e.location.data.row.email,company:e.location.data.row.company.companyName,userDiv:e.location.data.row.userDiv,mobileNo:e.location.data.row.mobileNo,username:e.location.data.row.username,adminRights:e.location.data.row.adminRights,activeStatus:e.location.data.row.activeStatus,userCanAssignForTask:e.location.data.row.userCanAssignForTask,visbilityBasedOn:e.location.data.row.visbilityBasedOn,projectCoordinator:e.location.data.row.projectCoordinator,isProjectCoordinator:e.location.data.row.isProjectCoordinator})})).catch((e=>{console.log(e)}))}),[]);const F=(e,a)=>{"clickaway"!==a&&_(!1)};return(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"content-wrapper",children:[(0,x.jsx)("div",{className:"content-header",children:(0,x.jsx)("section",{className:"content-header",children:(0,x.jsx)("div",{className:"container-fluid",children:(0,x.jsx)("div",{className:"row mb-2",children:(0,x.jsx)("div",{className:"col-sm-6",children:(0,x.jsx)("h1",{children:"Update User Details"})})})})})}),(0,x.jsx)("section",{className:"content",children:(0,x.jsx)("div",{className:"container-fluid",children:(0,x.jsxs)("form",{onSubmit:a=>{a.preventDefault();let o={};const i=(()=>{const{email:e,company:a,projectCoordinator:o,userDiv:i,visbilityBasedOn:n,mobileNo:s,verificationOne:t,verificationTwo:l,approval:r}=w,c={};return"Mobitel"===a&&"Choose..."===i&&(c.userDiv="Choose a division!"),"Mobitel"===a&&"Choose..."===n&&(c.visbilityBasedOn="Choose a option!"),e&&""!==e||(c.email="cannot be blank!"),s&&""!==s||(c.mobileNo="cannot be blank!"),c})();if(Object.keys(i).length>0)k(i);else{if("Mobitel"===w.company){var s=[w.verificationOneId,w.verificationTwoId,w.approvalId].filter((e=>"1"!==e)).filter((e=>"2"!==e));o={name:w.name,email:w.email,company:n.find((e=>e.companyName===w.company))._id,userDiv:w.userDiv,mobileNo:w.mobileNo,username:w.username,adminRights:w.adminRights,activeStatus:w.activeStatus,userCanAssignForTask:w.userCanAssignForTask,visbilityBasedOn:w.visbilityBasedOn,projectCoordinator:"1"==w.projectCoordinator?null:w.projectCoordinator,isProjectCoordinator:w.isProjectCoordinator,approvalPath:s}}else o={name:w.name,email:w.email,company:n.find((e=>e.companyName===w.company))._id,visbilityBasedOn:w.visbilityBasedOn,userDiv:w.userDiv,mobileNo:w.mobileNo,username:w.username,activeStatus:w.activeStatus};g.put("projonline/user/"+e.location.data.row._id,o,{headers:{token:"Bearer "+JSON.parse(localStorage.getItem("user")).accessToken}}).then((a=>{S(!0),setTimeout((()=>{C(a.data.msg),Z(a.data.variant),_(!0)}),2e3),setTimeout((()=>{S(!1),_(!1),e.history.push({pathname:"/updateUser"})}),5e3)})).catch((e=>{console.log(e)}))}},enctype:"multipart/form-data",children:[(0,x.jsxs)(l.Z,{className:"mb-3",children:[(0,x.jsxs)(r.Z.Group,{as:c.Z,children:[(0,x.jsx)(r.Z.Label,{children:"Name"}),(0,x.jsx)(r.Z.Control,{onChange:e=>T("name",e.target.value),value:w.name,className:"col-md-9",type:"text",isInvalid:!!f.name,disabled:!0}),(0,x.jsx)(r.Z.Control.Feedback,{type:"invalid",children:f.name})]}),(0,x.jsxs)(r.Z.Group,{as:c.Z,children:[(0,x.jsx)(r.Z.Label,{children:"Username"}),(0,x.jsx)(r.Z.Control,{onChange:e=>T("username",e.target.value),value:w.username,className:"col-md-9",type:"text",isInvalid:!!f.username,disabled:!0}),(0,x.jsx)(r.Z.Control.Feedback,{type:"invalid",children:f.username})]}),(0,x.jsxs)(r.Z.Group,{as:c.Z,children:[(0,x.jsx)(r.Z.Label,{children:"Email"}),(0,x.jsx)(r.Z.Control,{onChange:e=>T("email",e.target.value),value:w.email,className:"col-md-9",type:"text",isInvalid:!!f.email}),(0,x.jsx)(r.Z.Control.Feedback,{type:"invalid",children:f.email})]})]}),(0,x.jsxs)(l.Z,{className:"mb-3",children:[(0,x.jsxs)(r.Z.Group,{as:c.Z,children:[(0,x.jsx)(r.Z.Label,{children:"Company"}),(0,x.jsx)(r.Z.Control,{onChange:e=>T("company",e.target.value),value:w.company,className:"col-md-9",as:"select",defaultValue:"Choose...",isInvalid:!!f.company,children:n.map((e=>(0,x.jsx)("option",{value:e.companyName,children:e.companyName})))}),(0,x.jsx)(r.Z.Control.Feedback,{type:"invalid",children:f.company})]}),(0,x.jsxs)(r.Z.Group,{as:c.Z,children:[(0,x.jsx)(r.Z.Label,{children:"User Division"}),(0,x.jsxs)(r.Z.Control,{onChange:e=>T("userDiv",e.target.value),value:w.userDiv,className:"col-md-9",as:"select",defaultValue:"Choose...",isInvalid:!!f.userDiv,disabled:"Mobitel"!==w.company,children:[(0,x.jsx)("option",{value:"Choose...",children:"Choose..."}),(0,x.jsx)("option",{children:"Planning_Radio"}),(0,x.jsx)("option",{children:"Planning_Core"}),(0,x.jsx)("option",{children:"Planning_TX"}),(0,x.jsx)("option",{children:"Planning_IBS"}),(0,x.jsx)("option",{children:"Planning_WiFi"}),(0,x.jsx)("option",{children:"Project_Radio"}),(0,x.jsx)("option",{children:"Project_Core"}),(0,x.jsx)("option",{children:"Project_TX"}),(0,x.jsx)("option",{children:"Project_IBS"}),(0,x.jsx)("option",{children:"Project_WiFi"})]}),(0,x.jsx)(r.Z.Control.Feedback,{type:"invalid",children:f.userDiv})]}),(0,x.jsxs)(r.Z.Group,{as:c.Z,children:[(0,x.jsx)(r.Z.Label,{children:"Mobile No"}),(0,x.jsx)(r.Z.Control,{onChange:e=>T("mobileNo",e.target.value),value:w.mobileNo,className:"col-md-9",type:"number",isInvalid:!!f.mobileNo}),(0,x.jsx)(r.Z.Control.Feedback,{type:"invalid",children:f.mobileNo})]})]}),(0,x.jsxs)(l.Z,{className:"mb-3",children:[(0,x.jsxs)(r.Z.Group,{as:c.Z,children:[(0,x.jsx)(r.Z.Label,{children:"Visibility Based On"}),"Mobitel"!==w.company?(0,x.jsxs)(r.Z.Control,{onChange:e=>T("visbilityBasedOn",e.target.value),value:w.visbilityBasedOn,className:"col-md-9",as:"select",defaultValue:"Choose...",isInvalid:!!f.visbilityBasedOn,children:[(0,x.jsx)("option",{children:"Choose..."}),(0,x.jsx)("option",{value:"Subcon",children:"Subcon"}),(0,x.jsx)("option",{value:"Vender",children:"Vender"})]}):(0,x.jsx)("div",{children:(0,x.jsxs)(r.Z.Control,{onChange:e=>T("visbilityBasedOn",e.target.value),value:w.visbilityBasedOn,className:"col-md-9",as:"select",defaultValue:"Choose...",isInvalid:!!f.visbilityBasedOn,children:[(0,x.jsx)("option",{children:"Choose..."}),(0,x.jsx)("option",{value:"Admin",children:"Admin"}),(0,x.jsx)("option",{value:"Planning",children:"Planning"}),(0,x.jsx)("option",{value:"Project_Div_Head",children:"Project_Div_Head"}),(0,x.jsx)("option",{value:"Project_PM",children:"Project_PM"}),(0,x.jsx)("option",{value:"Project_TO",children:"Project_TO"}),(0,x.jsx)("option",{value:"Project_Coor",children:"Project_Coor"}),(0,x.jsx)("option",{value:"Subcon",children:"Subcon"}),(0,x.jsx)("option",{value:"Vender",children:"Vender"}),(0,x.jsx)("option",{value:"Optimization",children:"Optimization"})]})}),(0,x.jsx)(r.Z.Control.Feedback,{type:"invalid",children:f.visbilityBasedOn})]}),(0,x.jsxs)(r.Z.Group,{as:c.Z,children:[(0,x.jsx)(r.Z.Label,{children:"Project Coordinator"}),(0,x.jsxs)(r.Z.Control,{as:"select",onChange:e=>T("projectCoordinator",e.target.value),value:w.projectCoordinator,className:"col-md-9",defaultValue:"Choose...",isInvalid:!!f.visbilityBasedOn,disabled:"Mobitel"!==w.company,children:[(0,x.jsx)("option",{value:"1",children:"Choose..."}),a.map((e=>(0,x.jsx)("option",{value:e._id,children:e.name})))]}),(0,x.jsx)(r.Z.Control.Feedback,{type:"invalid",children:f.projectCoordinator})]}),(0,x.jsxs)(r.Z.Group,{as:c.Z,children:[(0,x.jsx)(r.Z.Label,{children:"Is Project Coordinator"}),(0,x.jsx)(r.Z.Check,{onChange:e=>T("isProjectCoordinator",!w.isProjectCoordinator),value:w.isProjectCoordinator,checked:w.isProjectCoordinator,className:"col-md-9",id:"custom-switch-4",type:"switch",disabled:"Mobitel"!==w.company})]})]}),(0,x.jsxs)(l.Z,{className:"mb-3",children:[(0,x.jsxs)(r.Z.Group,{as:c.Z,children:[(0,x.jsx)(r.Z.Label,{children:"Admin Rights"}),(0,x.jsx)(r.Z.Check,{onChange:e=>T("adminRights",!w.adminRights),value:w.adminRights,checked:w.adminRights,className:"col-md-9",id:"custom-switch-1",type:"switch",disabled:"Mobitel"!==w.company})]}),(0,x.jsxs)(r.Z.Group,{as:c.Z,children:[(0,x.jsx)(r.Z.Label,{children:"Active Status"}),(0,x.jsx)(r.Z.Check,{onChange:e=>T("activeStatus",!w.activeStatus),value:w.activeStatus,checked:w.activeStatus,className:"col-md-9",id:"custom-switch-2",type:"switch"})]}),(0,x.jsxs)(r.Z.Group,{as:c.Z,children:[(0,x.jsx)(r.Z.Label,{children:"User Can Assign For Task"}),(0,x.jsx)(r.Z.Check,{onChange:e=>T("userCanAssignForTask",!w.userCanAssignForTask),value:w.userCanAssignForTask,checked:w.userCanAssignForTask,className:"col-md-9",id:"custom-switch-3",type:"switch",disabled:"Mobitel"!==w.company})]})]}),(0,x.jsxs)(l.Z,{children:[(0,x.jsxs)(r.Z.Group,{as:c.Z,children:[(0,x.jsx)(r.Z.Label,{children:"Verification by (Level 1)"}),(0,x.jsxs)(r.Z.Control,{as:"select",className:"col-md-9",onChange:e=>T("verificationOneId",e.target.value),value:w.verificationOneId,defaultValue:"Choose...",disabled:"Mobitel"!==w.company||!1===w.userCanAssignForTask,children:[(0,x.jsx)("option",{value:"1",children:"Choose.."}),a.map((e=>(0,x.jsx)("option",{value:e._id,children:e.name})))]})]}),(0,x.jsxs)(r.Z.Group,{as:c.Z,children:[(0,x.jsx)(r.Z.Label,{children:"Verification by (Level 2)"}),(0,x.jsxs)(r.Z.Control,{as:"select",className:"col-md-9",onChange:e=>T("verificationTwoId",e.target.value),value:w.verificationTwoId,defaultValue:"Choose...",disabled:"Mobitel"!==w.company||!1===w.userCanAssignForTask,children:[(0,x.jsx)("option",{value:"1",children:"Choose.."}),(0,x.jsx)("option",{value:"2",children:"Not Applicable"}),a.map((e=>(0,x.jsx)("option",{value:e._id,children:e.name})))]})]}),(0,x.jsxs)(r.Z.Group,{as:c.Z,children:[(0,x.jsx)(r.Z.Label,{children:"Approval by"}),(0,x.jsxs)(r.Z.Control,{as:"select",className:"col-md-9",onChange:e=>T("approvalId",e.target.value),value:w.approvalId,defaultValue:"Choose...",disabled:"Mobitel"!==w.company||!1===w.userCanAssignForTask,children:[(0,x.jsx)("option",{value:"1",children:"Choose.."}),a.map((e=>(0,x.jsx)("option",{value:e._id,children:e.name})))]})]})]}),(0,x.jsx)(d.Z,{variant:"primary",type:"submit",children:"Update User Details"})]})})})]}),(0,x.jsx)(h.Z,{open:P,autoHideDuration:6e3,onClose:F,anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,x.jsx)(b,{onClose:F,severity:y,sx:{width:"100%"},children:m})}),(0,x.jsx)(j.Z,{open:O,onClose:F,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:(0,x.jsx)(p.Z,{children:(0,x.jsx)(u.Z,{sx:{display:"flex"},children:(0,x.jsx)(v.Z,{})})})})]})}))},97473:e=>{e.exports="object"==typeof self?self.FormData:window.FormData},55382:()=>{},72095:()=>{},61219:()=>{}}]);
//# sourceMappingURL=6878.bdec3a48.chunk.js.map