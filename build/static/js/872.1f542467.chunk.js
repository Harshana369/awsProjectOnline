(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[872],{31029:function(e,a,r){"use strict";r.r(a);var t=r(4942),n=r(29439),i=r(1413),o=r(72791),l=r(79271),d=r(74569),s=r.n(d),c=r(16149),u=r(89743),h=r(2677),C=r(43360),j=r(34575),m=r(19658),f=r(3986),x=r(58484),p=r.n(x),v=r(64554),Z=r(39157),b=r(13239),g=r(29818),N=r(80184),S=o.forwardRef((function(e,a){return(0,N.jsx)(m.Z,(0,i.Z)({elevation:6,ref:a,variant:"filled"},e))})),y=["csv","xls","xlsx"];a.default=(0,l.EN)((function(e){var a=(0,o.useState)([]),r=(0,n.Z)(a,2),l=r[0],d=r[1],m=(0,o.useState)([]),x=(0,n.Z)(m,2),V=x[0],w=x[1],k=(0,o.useState)(!1),F=(0,n.Z)(k,2),R=F[0],D=F[1],I=s().create({baseURL:"http://localhost:80/"}),T=(0,o.useState)({}),_=(0,n.Z)(T,2),P=_[0],G=_[1],L=(0,o.useState)({}),U=(0,n.Z)(L,2),E=U[0],O=U[1],B=(0,o.useState)(!1),H=(0,n.Z)(B,2),z=H[0],J=H[1],M=function(e,a){G((0,i.Z)((0,i.Z)({},P),{},(0,t.Z)({},e,a))),E[e]&&O((0,i.Z)((0,i.Z)({},E),{},(0,t.Z)({},e,null)))};(0,o.useEffect)((function(){I.get("projonline/users",{headers:{token:"Bearer "+JSON.parse(localStorage.getItem("user")).accessToken}}).then((function(e){d(e.data.companys.filter((function(e){return"Mobitel"!==e.companyName}))),G({})})).catch((function(e){console.log(e)}))}),[]);var A=function(e,a){"clickaway"!==a&&J(!1)};return(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{className:"content-wrapper",children:[(0,N.jsx)("div",{className:"content-header",children:(0,N.jsx)("section",{className:"content-header",children:(0,N.jsx)("div",{className:"container-fluid",children:(0,N.jsx)("div",{className:"row mb-2",children:(0,N.jsx)("div",{className:"col-sm-6",children:(0,N.jsx)("h1",{children:"Upload New Rate Card"})})})})})}),(0,N.jsx)("section",{className:"content",children:(0,N.jsxs)("div",{className:"container-fluid",children:[(0,N.jsxs)(c.Z,{onSubmit:function(e){e.preventDefault(),D(!0);var a=function(){var e=P.rateCardValidFrom,a=P.rateCardValidTo,r=P.rateCardDiv,t=P.rateCardSubcon,n={};return e&&""!==e||(n.rateCardValidFrom="cannot be blank!"),a&&""!==a||(n.rateCardValidTo="cannot be blank!"),r&&""!==r&&"Choose..."!==r||(n.rateCardDiv="Choose a division!"),t&&""!==t||(n.rateCardSubcon="Choose a Subcontractor!"),n}();if(Object.keys(a).length>0)O(a),D(!1);else{var r={rateCardValidFrom:P.rateCardValidFrom,rateCardValidTo:P.rateCardValidTo,rateCardDiv:P.rateCardDiv,rateCardSubcon:P.rateCardSubcon,rateCardItems:V};I.post("projonline/addRateCard",r,{headers:{token:"Bearer "+JSON.parse(localStorage.getItem("user")).accessToken}}).then((function(e){J(!0),G({rateCardValidFrom:"",rateCardValidTo:"",rateCardDiv:"",rateCardSubcon:""}),w([]),D(!1)})).catch((function(e){console.log(e)}))}},children:[(0,N.jsxs)(u.Z,{className:"mb-3",children:[(0,N.jsxs)(c.Z.Group,{as:h.Z,children:[(0,N.jsx)(c.Z.Label,{children:"Division"}),(0,N.jsxs)(c.Z.Control,{onChange:function(e){return M("rateCardDiv",e.target.value)},value:P.rateCardDiv,as:"select",defaultValue:"Choose...",isInvalid:!!E.rateCardDiv,children:[(0,N.jsx)("option",{children:"Choose..."}),(0,N.jsx)("option",{children:"Project_Radio"}),(0,N.jsx)("option",{children:"Project_Core"}),(0,N.jsx)("option",{children:"Project_TX"}),(0,N.jsx)("option",{children:"Project_IBS"}),(0,N.jsx)("option",{children:"Project_WiFi"})]}),(0,N.jsx)(c.Z.Control.Feedback,{type:"invalid",children:E.rateCardDiv})]}),(0,N.jsxs)(c.Z.Group,{as:h.Z,children:[(0,N.jsx)(c.Z.Label,{children:"Subcontractor"}),(0,N.jsxs)(c.Z.Control,{onChange:function(e){return M("rateCardSubcon",e.target.value)},value:P.rateCardSubcon,as:"select",defaultValue:"Choose...",isInvalid:!!E.rateCardSubcon,children:[(0,N.jsx)("option",{children:"Choose..."}),l.map((function(e){return(0,N.jsx)("option",{value:e._id,children:e.companyName})}))]}),(0,N.jsx)(c.Z.Control.Feedback,{type:"invalid",children:E.rateCardSubcon})]}),(0,N.jsx)(c.Z.Group,{as:h.Z})]}),(0,N.jsxs)(u.Z,{className:"mb-3",children:[(0,N.jsxs)(c.Z.Group,{as:h.Z,children:[(0,N.jsx)(c.Z.Label,{children:"Rate Card Valid From"}),(0,N.jsx)(c.Z.Control,{onChange:function(e){return M("rateCardValidFrom",e.target.value)},value:P.rateCardValidFrom,className:"col-md-9",type:"date",isInvalid:!!E.rateCardValidFrom}),(0,N.jsx)(c.Z.Control.Feedback,{type:"invalid",children:E.rateCardValidFrom})]}),(0,N.jsxs)(c.Z.Group,{as:h.Z,children:[(0,N.jsx)(c.Z.Label,{children:"Rate Card Valid To"}),(0,N.jsx)(c.Z.Control,{onChange:function(e){return M("rateCardValidTo",e.target.value)},value:P.rateCardValidTo,className:"col-md-9",type:"date",isInvalid:!!E.rateCardValidTo}),(0,N.jsx)(c.Z.Control.Feedback,{type:"invalid",children:E.rateCardValidTo})]}),(0,N.jsx)(c.Z.Group,{as:h.Z})]}),(0,N.jsx)(u.Z,{className:"mb-3",children:(0,N.jsxs)(c.Z.Group,{as:h.Z,children:[(0,N.jsx)(c.Z.Label,{children:"Upload the rate sheet"}),(0,N.jsx)(c.Z.Control,{onChange:function(e){var a=e.target.files[0],r=new FileReader;r.onload=function(e){var a=e.target.result,r=p().read(a,{type:"binary"}),t=r.SheetNames[0],n=r.Sheets[t],i=p().utils.sheet_to_json(n,{header:1}),o=i[0];i.splice(0,1),w(function(e,a){var r=[];return a.forEach((function(a,t){var n={};n.id=t,a.forEach((function(a,r){n[e[r]]=a})),r.push(n)})),r}(o,i))},a?!function(e){var a=e.name.split("."),r=a[a.length-1];return y.includes(r)}(a)?alert("Invalid file"):r.readAsBinaryString(a):w([])},type:"file",isInvalid:!!E.file}),(0,N.jsx)(c.Z.Control.Feedback,{type:"invalid",children:E.fi})]})}),(0,N.jsx)(u.Z,{className:"mb-3",children:(0,N.jsx)(C.Z,{variant:"primary",type:"submit",children:"Submit a Rate Card"})})]}),(0,N.jsx)("div",{style:{height:610,width:"100%"},children:(0,N.jsx)(f._$r,{getRowId:function(e){return e.id},rows:V,columns:[{field:"erpCode",headerName:"ERP Code",width:130},{field:"itemNo",headerName:"Item No",width:130},{field:"itemDiscreption",headerName:"Item Discreption",width:400},{field:"itemUom",headerName:"Item UoM",width:180},{field:"itemRate",headerName:"Rate (LKR)",width:180}],pageSize:15,rowsPerPageOptions:[15],rowHeight:30,headerHeight:40,components:{Toolbar:f.npt}})})]})})]}),(0,N.jsx)(j.Z,{open:z,autoHideDuration:6e3,onClose:A,anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,N.jsx)(S,{onClose:A,severity:"success",sx:{width:"100%"},children:"Rate Card Uploaded successfully!!!"})}),(0,N.jsx)(g.Z,{open:R,onClose:function(e,a){"clickaway"!==a&&J(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:(0,N.jsx)(Z.Z,{children:(0,N.jsx)(v.Z,{sx:{display:"flex"},children:(0,N.jsx)(b.Z,{})})})})]})}))},55382:function(){},72095:function(){},61219:function(){}}]);
//# sourceMappingURL=872.1f542467.chunk.js.map