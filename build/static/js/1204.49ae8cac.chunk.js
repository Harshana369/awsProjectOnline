(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1204],{51011:function(e,t,n){"use strict";n.r(t);var a=n(4942),r=n(29439),s=n(1413),o=n(72791),c=n(79271),l=n(74569),i=n.n(l),d=n(16149),u=n(89743),j=n(2677),h=n(43360),p=n(34575),f=n(19658),m=n(3986),Z=n(58484),x=n.n(Z),g=n(64554),v=n(39157),b=n(13239),N=n(29818),S=n(80184),P=o.forwardRef((function(e,t){return(0,S.jsx)(f.Z,(0,s.Z)({elevation:6,ref:t,variant:"filled"},e))})),y=["csv","xls","xlsx"];t.default=(0,c.EN)((function(e){var t=(0,o.useState)([]),n=(0,r.Z)(t,2),c=(n[0],n[1]),l=(0,o.useState)([]),f=(0,r.Z)(l,2),Z=f[0],C=f[1],k=(0,o.useState)(),I=(0,r.Z)(k,2),w=(I[0],I[1],(0,o.useState)([])),D=(0,r.Z)(w,2),M=D[0],O=D[1],E=(0,o.useState)(""),F=(0,r.Z)(E,2),L=F[0],T=F[1],G=(0,o.useState)(""),B=(0,r.Z)(G,2),H=B[0],R=B[1],_=(0,o.useState)([]),z=(0,r.Z)(_,2),J=(z[0],z[1]),U=(0,o.useState)([]),A=(0,r.Z)(U,2),V=A[0],W=A[1],$=(0,o.useState)(!1),q=(0,r.Z)($,2),K=q[0],Q=q[1],X=i().create({baseURL:"http://ec2-65-2-5-82.ap-south-1.compute.amazonaws.com/"}),Y=(0,o.useState)({}),ee=(0,r.Z)(Y,2),te=ee[0],ne=ee[1],ae=(0,o.useState)({}),re=(0,r.Z)(ae,2),se=re[0],oe=re[1],ce=(0,o.useState)(!1),le=(0,r.Z)(ce,2),ie=le[0],de=le[1],ue=function(e,t){ne((0,s.Z)((0,s.Z)({},te),{},(0,a.Z)({},e,t))),se[e]&&oe((0,s.Z)((0,s.Z)({},se),{},(0,a.Z)({},e,null)))};(0,o.useEffect)((function(){X.get("projonline/users",{headers:{token:"Bearer "+JSON.parse(localStorage.getItem("user")).accessToken}}).then((function(e){c(e.data.companys.filter((function(e){return"Mobitel"!==e.companyName}))),J(e.data.projects),ue("projectID",e.data.projects.length+1)})).catch((function(e){console.log(e)})),X.get("projonline/mobitelusers",{headers:{token:"Bearer "+JSON.parse(localStorage.getItem("user")).accessToken}}).then((function(e){W(e.data)})).catch((function(e){console.log(e)}))}),[]);var je=function(e,t){"clickaway"!==t&&de(!1)};return(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"content-wrapper",children:[(0,S.jsx)("div",{className:"content-header",children:(0,S.jsx)("section",{className:"content-header",children:(0,S.jsx)("div",{className:"container-fluid",children:(0,S.jsx)("div",{className:"row mb-2",children:(0,S.jsx)("div",{className:"col-sm-6",children:(0,S.jsx)("h1",{children:"Upload New Project Temptate"})})})})})}),(0,S.jsx)("section",{className:"content",children:(0,S.jsxs)("div",{className:"container-fluid",children:[(0,S.jsxs)(d.Z,{onSubmit:function(e){e.preventDefault(),Q(!0);var t=function(){var e=te.subProject,t=te.project,n={};return e&&""!==e||(n.subProject="cannot be blank!"),t&&""!==t||(n.project="cannot be blank!"),M&&0!==M.length||(n.file="Attachment missing!"),n}();if(Object.keys(t).length>0)oe(t),Q(!1);else{var n={projectID:te.projectID,subProject:te.subProject,project:te.project,properties:M.map((function(e){return e.field})),assignedProjectManager:te.assignedProjectManager,taskStatus:"Project template created"};X.post("projonline/addProjectTemplate",n,{headers:{token:"Bearer "+JSON.parse(localStorage.getItem("user")).accessToken}}).then((function(e){T(e.data.msg),R(e.data.variant),de(!0),ne({project:"",subProject:"",projectID:"",assignedProjectManager:""}),C([]),O([]),Q(!1)})).catch((function(e){console.log(e)}))}},children:[(0,S.jsxs)(u.Z,{className:"mb-3",children:[(0,S.jsxs)(d.Z.Group,{as:j.Z,children:[(0,S.jsx)(d.Z.Label,{children:"Project ID"}),(0,S.jsx)(d.Z.Control,{disabled:!0,onChange:function(e){return ue("projectID",e.target.value)},value:te.projectID,className:"col-md-9",type:"text",placeholder:"Enter Project Name",isInvalid:!!se.projectID}),(0,S.jsx)(d.Z.Control.Feedback,{type:"invalid",children:se.projectID})]}),(0,S.jsxs)(d.Z.Group,{as:j.Z,children:[(0,S.jsx)(d.Z.Label,{children:"Project Manager"}),(0,S.jsxs)(d.Z.Control,{onChange:function(e){return ue("assignedProjectManager",e.target.value)},value:te.assignedProjectManager,className:"col-md-9",as:"select",defaultValue:"Choose...",isInvalid:!!se.assignedProjectManager,children:[(0,S.jsx)("option",{children:"Choose..."}),V.map((function(e){return(0,S.jsx)("option",{value:e._id,children:e.name})}))]}),(0,S.jsx)(d.Z.Control.Feedback,{type:"invalid",children:se.assignedMobitelOfficer})]})]}),(0,S.jsxs)(u.Z,{className:"mb-3",children:[(0,S.jsxs)(d.Z.Group,{as:j.Z,children:[(0,S.jsx)(d.Z.Label,{children:"Project Name"}),(0,S.jsx)(d.Z.Control,{onChange:function(e){return ue("project",e.target.value)},value:te.project,className:"col-md-9",type:"text",placeholder:"Enter Project Name",isInvalid:!!se.project}),(0,S.jsx)(d.Z.Control.Feedback,{type:"invalid",children:se.project})]}),(0,S.jsxs)(d.Z.Group,{as:j.Z,children:[(0,S.jsx)(d.Z.Label,{children:"Sub-Project Name"}),(0,S.jsx)(d.Z.Control,{onChange:function(e){return ue("subProject",e.target.value)},value:te.subProject,className:"col-md-9",type:"text",placeholder:"Enter Sub-Project Name",isInvalid:!!se.subProject}),(0,S.jsx)(d.Z.Control.Feedback,{type:"invalid",children:se.subProject})]})]}),(0,S.jsx)(u.Z,{className:"mb-3",children:(0,S.jsxs)(d.Z.Group,{as:j.Z,children:[(0,S.jsx)(d.Z.Label,{children:"Upload the project HO template"}),(0,S.jsx)(d.Z.Control,{onChange:function(e){var t=e.target.files[0];oe((0,s.Z)((0,s.Z)({},se),{},{file:null}));var n=new FileReader;n.onload=function(e){var t=e.target.result,n=x().read(t,{type:"binary"}),a=n.SheetNames[0],r=n.Sheets[a],s=x().utils.sheet_to_json(r,{header:1}),o=s[0],c=[];if("Site ID"===s[0][1]&&"Site Name"===s[0][2]){for(var l=0;l<s[0].length;l++){var i={field:s[0][l],headerName:s[0][l],minWidth:150,flex:1};c.push(i)}O(c),s.splice(0,1),C(function(e,t){var n=[];return t.forEach((function(t,a){var r={};r.id=a,t.forEach((function(t,n){r[e[n]]=t})),n.push(r)})),n}(o,s))}else de(!0),R("error"),T("Site ID and Site Name should be in Column No 2 and 3"),C([]),O([])},t?!function(e){var t=e.name.split("."),n=t[t.length-1];return y.includes(n)}(t)?alert("Invalid file"):n.readAsBinaryString(t):C([])},type:"file",isInvalid:!!se.file}),(0,S.jsx)(d.Z.Control.Feedback,{type:"invalid",children:se.file})]})}),(0,S.jsx)(u.Z,{className:"mb-3",children:(0,S.jsx)(h.Z,{variant:"primary",type:"submit",children:"Create the template"})})]}),(0,S.jsx)("div",{style:{height:610,width:"100%"},children:(0,S.jsx)(m._$r,{getRowId:function(e){return e.id},rows:Z,columns:M,pageSize:15,rowsPerPageOptions:[15],rowHeight:30,headerHeight:40,components:{Toolbar:m.npt}})})]})})]}),(0,S.jsx)(p.Z,{open:ie,autoHideDuration:6e3,onClose:je,anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,S.jsx)(P,{onClose:je,severity:H,sx:{width:"100%"},children:L})}),(0,S.jsx)(N.Z,{open:K,onClose:function(e,t){"clickaway"!==t&&de(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:(0,S.jsx)(v.Z,{children:(0,S.jsx)(g.Z,{sx:{display:"flex"},children:(0,S.jsx)(b.Z,{})})})})]})}))},55382:function(){},72095:function(){},61219:function(){}}]);
//# sourceMappingURL=1204.49ae8cac.chunk.js.map