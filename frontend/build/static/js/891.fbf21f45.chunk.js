(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[891],{61524:function(e,t,n){"use strict";n.r(t);var s=n(93433),r=n(4942),o=n(29439),i=n(1413),a=n(72791),l=n(79271),c=n(74569),d=n.n(c),u=n(16149),h=n(89743),j=n(2677),p=n(43360),f=n(34575),v=n(19658),g=n(3986),x=n(58484),Z=n.n(x),b=n(29818),m=n(64554),k=n(39157),C=n(97473),P=n.n(C),y=n(13239),S=n(80184),D=a.forwardRef((function(e,t){return(0,S.jsx)(v.Z,(0,i.Z)({elevation:6,ref:t,variant:"filled"},e))})),A=["csv","xls","xlsx"];function w(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((function(e,n){return e===t[n]}))}t.default=(0,l.EN)((function(e){var t=(0,a.useState)([]),n=(0,o.Z)(t,2),l=n[0],c=n[1],v=(0,a.useState)([]),x=(0,o.Z)(v,2),C=x[0],F=x[1],I=(0,a.useState)(""),N=(0,o.Z)(I,2),_=N[0],T=N[1],V=(0,a.useState)([]),L=(0,o.Z)(V,2),G=L[0],R=L[1],O=(0,a.useState)([]),B=(0,o.Z)(O,2),H=B[0],M=B[1],E=(0,a.useState)([]),W=(0,o.Z)(E,2),J=W[0],z=W[1],U=(0,a.useState)(0),X=(0,o.Z)(U,2),$=X[0],q=X[1],K=(0,a.useState)(""),Q=(0,o.Z)(K,2),Y=Q[0],ee=Q[1],te=(0,a.useState)(""),ne=(0,o.Z)(te,2),se=ne[0],re=ne[1],oe=(0,a.useState)(""),ie=(0,o.Z)(oe,2),ae=ie[0],le=ie[1],ce=(0,a.useState)([]),de=(0,o.Z)(ce,2),ue=de[0],he=de[1],je=(0,a.useState)([]),pe=(0,o.Z)(je,2),fe=pe[0],ve=pe[1],ge=(0,a.useState)([]),xe=(0,o.Z)(ge,2),Ze=xe[0],be=xe[1],me=d().create({baseURL:"http://localhost:8072/"}),ke=(0,a.useState)({}),Ce=(0,o.Z)(ke,2),Pe=Ce[0],ye=Ce[1],Se=(0,a.useState)({}),De=(0,o.Z)(Se,2),Ae=De[0],we=De[1],Fe=(0,a.useState)(!1),Ie=(0,o.Z)(Fe,2),Ne=Ie[0],_e=Ie[1],Te=(0,a.useState)(!1),Ve=(0,o.Z)(Te,2),Le=Ve[0],Ge=Ve[1],Re=(0,a.useRef)(),Oe=function(e,t){ye((0,i.Z)((0,i.Z)({},Pe),{},(0,r.Z)({},e,t))),Ae[e]&&we((0,i.Z)((0,i.Z)({},Ae),{},(0,r.Z)({},e,null)))};(0,a.useEffect)((function(){me.get("projonline/project",{headers:{token:"Bearer "+JSON.parse(localStorage.getItem("user")).accessToken}}).then((function(e){ye({}),R((0,s.Z)(new Set(e.data.projTemplates.map((function(e){return e.project}))))),z((0,s.Z)(new Set(e.data.projTemplates.map((function(e){return e.subProject}))))),M(e.data.projTemplates);var t=e.data.tasks.filter((function(e){if("Withdraw"!=e.taskStatus)return e}));he(t),ve(t)})).catch((function(e){console.log(e)}))}),[]);var Be=function(e,t){var n=[];return t.forEach((function(t,s){var r={};r.id=s,t.forEach((function(t,n){r[e[n]]=t})),n.push(r)})),n},He=function(e,t){"clickaway"!==t&&_e(!1)};return(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"content-wrapper",children:[(0,S.jsx)("div",{className:"content-header",children:(0,S.jsx)("section",{className:"content-header",children:(0,S.jsx)("div",{className:"container-fluid",children:(0,S.jsx)("div",{className:"row mb-2",children:(0,S.jsx)("div",{className:"col-sm-6",children:(0,S.jsx)("h1",{children:"Handover New Tasks"})})})})})}),(0,S.jsx)("section",{className:"content",children:(0,S.jsxs)("div",{className:"container-fluid",children:[(0,S.jsxs)(u.Z,{onSubmit:function(e){e.preventDefault();var t=function(){var e=Pe.project,t=Pe.subProject,n=Pe.taskAssignedFromDiV,s=Pe.taskAssignedDiv,r={};return e&&""!==e&&"Choose..."!==n||(r.project="cannot be blank!"),t&&""!==t&&"Choose..."!==n||(r.subProject="cannot be blank!"),n&&""!==n&&"Choose..."!==n||(r.taskAssignedFromDiV="Choose a division!"),s&&""!==s&&"Choose..."!==s||(r.taskAssignedDiv="Choose a division!"),C&&0!==C.length||(r.file="Attachment missing!"),r}();if(Object.keys(t).length>0)we(t),console.log(t);else{var n=new(P());n.append("files",Ze[0]),console.log(Ze[0]),console.log(n);var s={taskAssignedFromDiV:Pe.taskAssignedFromDiV,taskAssignedDiv:Pe.taskAssignedDiv,assignedProjectManager:Y._id,project:Pe.project,subProject:Pe.subProject,projectID:$,taskStatus:"Task handed over",properties:ae,priority:Pe.priority,headerProperties:C.map((function(e){return e.field}))};Ge(!0),me.post("projonline/upload",n,{headers:{token:"Bearer "+JSON.parse(localStorage.getItem("user")).accessToken,"Content-type":"multipart/form-data"}}).then((function(e){s.handoverFiles=e.data,console.log(s),me.post("projonline/addTask",s,{headers:{token:"Bearer "+JSON.parse(localStorage.getItem("user")).accessToken}}).then((function(e){console.log("Test"),setTimeout((function(){T(e.data.msg),re(e.data.variant),ye({taskAssignedFromDiV:"",taskAssignedDiv:"",project:"",subProject:"",priority:"None"}),q(""),ee(""),_e(!0)}),2e3),setTimeout((function(){Ge(!1),_e(!1),c([]),F([]),Re.current.value=""}),5e3)})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}},children:[(0,S.jsxs)(h.Z,{className:"mb-3",children:[(0,S.jsxs)(u.Z.Group,{as:j.Z,children:[(0,S.jsx)(u.Z.Label,{children:"From: Division"}),(0,S.jsxs)(u.Z.Control,{onChange:function(e){return Oe("taskAssignedFromDiV",e.target.value)},value:Pe.taskAssignedFromDiV,as:"select",defaultValue:"Choose...",isInvalid:!!Ae.taskAssignedFromDiV,children:[(0,S.jsx)("option",{children:"Choose..."}),(0,S.jsx)("option",{children:"Planning_Radio"}),(0,S.jsx)("option",{children:"Planning_Core"}),(0,S.jsx)("option",{children:"Planning_TX"}),(0,S.jsx)("option",{children:"Planning_IBS"}),(0,S.jsx)("option",{children:"Planning_WiFi"})]}),(0,S.jsx)(u.Z.Control.Feedback,{type:"invalid",children:Ae.taskAssignedFromDiV})]}),(0,S.jsxs)(u.Z.Group,{as:j.Z,children:[(0,S.jsx)(u.Z.Label,{children:"Assign to: Division"}),(0,S.jsxs)(u.Z.Control,{onChange:function(e){return Oe("taskAssignedDiv",e.target.value)},value:Pe.taskAssignedDiv,as:"select",defaultValue:"Choose...",isInvalid:!!Ae.taskAssignedDiv,children:[(0,S.jsx)("option",{children:"Choose..."}),(0,S.jsx)("option",{children:"Project_Radio"}),(0,S.jsx)("option",{children:"Project_Core"}),(0,S.jsx)("option",{children:"Project_TX"}),(0,S.jsx)("option",{children:"Project_IBS"}),(0,S.jsx)("option",{children:"Project_WiFi"})]}),(0,S.jsx)(u.Z.Control.Feedback,{type:"invalid",children:Ae.taskAssignedDiv})]}),(0,S.jsxs)(u.Z.Group,{as:j.Z,children:[(0,S.jsx)(u.Z.Label,{children:"Project Manager"}),(0,S.jsx)(u.Z.Control,{disabled:!0,value:Y.name,className:"",type:"text",placeholder:"Project Manager",isInvalid:!!Ae.assignedProjectManager}),(0,S.jsx)(u.Z.Control.Feedback,{type:"invalid",children:Ae.taskAssignedDiv})]})]}),(0,S.jsxs)(h.Z,{className:"mb-3",children:[(0,S.jsx)(j.Z,{sm:4,children:(0,S.jsxs)(u.Z.Group,{children:[(0,S.jsx)(u.Z.Label,{children:"Project"}),(0,S.jsxs)(u.Z.Control,{onChange:function(e){Oe("project",e.target.value);var t=H.filter((function(t){return t.project==e.target.value}));z((0,s.Z)(new Set(t.map((function(e){return e.subProject})))));for(var n=0;n<H.length;n++)e.target.value==H[n].project&&Pe.subProject==H[n].subProject?(q(H[n].projectID),n=H.length):n==H.length-1&&q("")},value:Pe.project,as:"select",defaultValue:"Choose...",isInvalid:!!Ae.project,children:[(0,S.jsx)("option",{value:"",children:"Choose..."}),G.map((function(e){return(0,S.jsx)("option",{value:e,children:e})}))]}),(0,S.jsx)(u.Z.Control.Feedback,{type:"invalid",children:Ae.project})]})}),(0,S.jsx)(j.Z,{sm:4,children:(0,S.jsxs)(u.Z.Group,{children:[(0,S.jsx)(u.Z.Label,{children:"Sub Project"}),(0,S.jsxs)(u.Z.Control,{onChange:function(e){Oe("subProject",e.target.value);for(var t=0;t<H.length;t++)Pe.project==H[t].project&&e.target.value==H[t].subProject?(ee(H[t].assignedProjectManager),q(H[t].projectID),t=H.length):t==H.length-1&&(q(""),ee(""))},disabled:!Pe.project,value:Pe.subProject,as:"select",defaultValue:"Choose...",isInvalid:!!Ae.subProject,children:[(0,S.jsx)("option",{children:"Choose..."}),J.map((function(e){return(0,S.jsx)("option",{value:e,children:e})}))]}),(0,S.jsx)(u.Z.Control.Feedback,{type:"invalid",children:Ae.subProject})]})}),(0,S.jsx)(j.Z,{sm:2,children:(0,S.jsxs)(u.Z.Group,{children:[(0,S.jsx)(u.Z.Label,{children:"Project ID"}),(0,S.jsx)(u.Z.Control,{disabled:!0,value:$,className:"",type:"text",placeholder:"Project ID",isInvalid:!!Ae.projectID}),(0,S.jsx)(u.Z.Control.Feedback,{type:"invalid",children:Ae.projectID})]})}),(0,S.jsx)(j.Z,{sm:2,children:(0,S.jsxs)(u.Z.Group,{children:[(0,S.jsx)(u.Z.Label,{children:"Priority"}),(0,S.jsxs)(u.Z.Control,{onChange:function(e){return Oe("priority",e.target.value)},disabled:!Pe.project,value:Pe.priority,as:"select",defaultValue:"None",isInvalid:!!Ae.priority,children:[(0,S.jsx)("option",{children:"None"}),(0,S.jsx)("option",{children:"High Priority"}),(0,S.jsx)("option",{children:"VIP"})]}),(0,S.jsx)(u.Z.Control.Feedback,{type:"invalid",children:Ae.priority})]})})]}),(0,S.jsx)(h.Z,{className:"mb-3",children:(0,S.jsxs)(u.Z.Group,{as:j.Z,children:[(0,S.jsx)(u.Z.Label,{children:"Upload new task handover"}),(0,S.jsx)(u.Z.Control,{onChange:function(e){var t=e.target.files[0];we((0,i.Z)((0,i.Z)({},Ae),{},{file:null})),be(e.target.files);var n=new FileReader;n.onload=function(e){for(var t=e.target.result,n=Z().read(t,{type:"binary"}),s=n.SheetNames[0],r=n.Sheets[s],o=Z().utils.sheet_to_json(r,{header:1}),i=o[0],a=[],l=0;l<H.length;l++)if(H[l].projectID===$)if(w(H[l].properties,i)){for(var d=0;d<o[0].length;d++){var u={field:o[0][d],headerName:o[0][d],minWidth:150,flex:1};a.push(u)}F(a),o.splice(0,1),le(o),c(Be(i,o)),l=H.length}else _e(!0),re("error"),T("Project Template is different"),c([]),F([]),l=H.length;else l==H.length-1&&(_e(!0),re("error"),T("Project Supproject combination is not available"),c([]),F([]))},t?!function(e){var t=e.name.split("."),n=t[t.length-1];return A.includes(n)}(t)?alert("Invalid file"):n.readAsBinaryString(t):c([])},ref:Re,type:"file",isInvalid:!!Ae.file}),(0,S.jsx)(u.Z.Control.Feedback,{type:"invalid",children:Ae.file})]})}),(0,S.jsxs)(h.Z,{className:"mb-3",children:[(0,S.jsx)(p.Z,{variant:"primary",type:"submit",children:"Handover new tasks"}),(0,S.jsxs)(j.Z,{children:[" ",(0,S.jsx)(p.Z,{variant:"outline-success",onClick:function(e){var t=function(){var e=Pe.project,t=Pe.subProject,n=Pe.taskAssignedFromDiV,s=(Pe.taskAssignedDiv,{});return e&&""!==e&&"Choose..."!==n||(s.project="cannot be blank!"),t&&""!==t&&"Choose..."!==n||(s.subProject="cannot be blank!"),s}();if(Object.keys(t).length>0)we(t);else if(fe.length>0){for(var n=Z().utils.book_new(),s=[],r=ue.filter((function(e){return e.project==Pe.project&&e.subProject==Pe.subProject})),o=0;o<r.length;o++){var i=r[o].properties;i.unshift(r[o].taskRef),s.unshift(i)}var a=r[0].headerProperties;a.unshift("Task ID"),s.unshift(a);var l=Z().utils.aoa_to_sheet(s);Z().utils.book_append_sheet(n,l,"sheet1"),Z().writeFile(n,"Already handedover tasks.xlsx"),s=[],r=[],a=[],he(fe)}else _e(!0),re("error"),T("Project Supproject combination is not available")},children:"Dowanload already handed over tasks"})]})]})]}),(0,S.jsx)("div",{style:{height:610,width:"100%"},children:(0,S.jsx)(g._$r,{getRowId:function(e){return e.id},rows:l,columns:C,pageSize:15,rowsPerPageOptions:[15],rowHeight:30,headerHeight:40,components:{Toolbar:g.npt}})})]})})]}),(0,S.jsx)(f.Z,{open:Ne,autoHideDuration:6e3,onClose:He,anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,S.jsx)(D,{onClose:He,severity:se,sx:{width:"100%"},children:_})}),(0,S.jsx)(b.Z,{open:Le,onClose:He,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:(0,S.jsx)(k.Z,{children:(0,S.jsx)(m.Z,{sx:{display:"flex"},children:(0,S.jsx)(y.Z,{})})})})]})}))},97473:function(e){e.exports="object"==typeof self?self.FormData:window.FormData},55382:function(){},72095:function(){},61219:function(){}}]);
//# sourceMappingURL=891.fbf21f45.chunk.js.map